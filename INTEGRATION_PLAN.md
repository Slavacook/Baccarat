# üìã –ü–õ–ê–ù –ò–ù–¢–ï–ì–†–ê–¶–ò–ò –ù–û–í–û–ì–û –§–£–ù–ö–¶–ò–û–ù–ê–õ–ê

## üéØ –¶–ï–õ–ò

1. **–í–∏–∑—É–∞–ª—å–Ω—ã–µ —Ñ–∏—à–∫–∏ –Ω–∞ –ø–æ–ª–µ** - –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ toggles
2. **–°—Ç–∞–≤–∫–∏ –Ω–∞ –ø–∞—Ä—ã** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä –≤ –ø–µ—Ä–≤—ã—Ö 4 –∫–∞—Ä—Ç–∞—Ö, —Ä–∞–Ω–¥–æ–º–Ω—ã–µ —Å—Ç–∞–≤–∫–∏
3. **Toggleable –º–∞—Ä–∫–µ—Ä—ã** - –º–æ–∂–Ω–æ –≤–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –º–∞—Ä–∫–µ—Ä –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
4. **–ö–Ω–æ–ø–∫–∞ "–ö–∞—Ä—Ç—ã"** - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—ã–±–æ—Ä –ø–æ–±–µ–¥–∏—Ç–µ–ª—è (–≤–º–µ—Å—Ç–æ –∞–≤—Ç–æ–ø—Ä–æ–≤–µ—Ä–∫–∏)
5. **–†—É—á–Ω–∞—è –æ–ø–ª–∞—Ç–∞** - –∫–ª–∏–∫ –Ω–∞ —Ñ–∏—à–∫—É ‚Üí PayoutScene, –≤–æ–∑–≤—Ä–∞—Ç –Ω–∞ —Ç–æ—Ç –∂–µ —ç–∫—Ä–∞–Ω
6. **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤—ã–ø–ª–∞—Ç—ã** - –æ–ø–ª–∞—á–∏–≤–∞—Ç—å –ø–∞—Ä—ã –∏ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∞–≤–∫–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ
7. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö —Å—Ç–∞–≤–æ–∫** - –æ—à–∏–±–∫–∞ –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ "–ö–∞—Ä—Ç—ã" —Å –Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–º–∏ —Å—Ç–∞–≤–∫–∞–º–∏

---

## üèóÔ∏è –ê–†–•–ò–¢–ï–ö–¢–£–†–ê

### –ú–µ–Ω–µ–¥–∂–µ—Ä—ã (—Å–æ–∑–¥–∞–Ω—ã):

1. **ChipVisualManager** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∏–∑—É–∞–ª—å–Ω—ã–º–∏ —Ñ–∏—à–∫–∞–º–∏
2. **WinnerSelectionManager** - toggleable –º–∞—Ä–∫–µ—Ä—ã –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π
3. **PayoutQueueManager** - –æ—á–µ—Ä–µ–¥—å –≤—ã–ø–ª–∞—Ç
4. **PairBettingManager** - —Å—Ç–∞–≤–∫–∏ –Ω–∞ –ø–∞—Ä—ã

### –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏–π –≤ –∏–≥—Ä–µ:

```
1. –ù–ê–ß–ê–õ–û –†–ê–£–ù–î–ê
   ‚îú‚îÄ –í–∫–ª—é—á–∏—Ç—å toggles —Å—Ç–∞–≤–æ–∫ (Player/Banker/Tie)
   ‚îú‚îÄ –†–∞–Ω–¥–æ–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞–≤–∫–∏ –Ω–∞ –ø–∞—Ä—ã (PairPlayer/PairBanker)
   ‚îî‚îÄ –ü–æ–∫–∞–∑–∞—Ç—å —Ñ–∏—à–∫–∏ –Ω–∞ –ø–æ–ª–µ

2. –†–ê–ó–î–ê–ß–ê –ö–ê–†–¢
   ‚îú‚îÄ –†–∞–∑–¥–∞—Ç—å –ø–µ—Ä–≤—ã–µ 4 –∫–∞—Ä—Ç—ã
   ‚îú‚îÄ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–∞—Ä—ã –≤ –ø–µ—Ä–≤—ã—Ö 4 –∫–∞—Ä—Ç–∞—Ö
   ‚îú‚îÄ –î–æ–±–∞–≤–∏—Ç—å –≤—ã–∏–≥—Ä–∞–≤—à–∏–µ –ø–∞—Ä—ã –≤ PayoutQueue
   ‚îî‚îÄ –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Ä–∞–∑–¥–∞—á—É (—Ç—Ä–µ—Ç—å–∏ –∫–∞—Ä—Ç—ã –ø–æ –ø—Ä–∞–≤–∏–ª–∞–º)

3. –í–´–ë–û–† –ü–û–ë–ï–î–ò–¢–ï–õ–Ø
   ‚îú‚îÄ –î–∏–ª–µ—Ä –∫–ª–∏–∫–∞–µ—Ç –Ω–∞ –º–∞—Ä–∫–µ—Ä (Player/Banker/Tie)
   ‚îú‚îÄ –ú–∞—Ä–∫–µ—Ä –ø–æ–¥—Å–≤–µ—á–∏–≤–∞–µ—Ç—Å—è (–º–æ–∂–Ω–æ –æ—Ç–º–µ–Ω–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω—ã–º –∫–ª–∏–∫–æ–º)
   ‚îî‚îÄ –î–∏–ª–µ—Ä –≥–æ—Ç–æ–≤ ‚Üí –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É "–ö–∞—Ä—Ç—ã"

4. –ü–†–û–í–ï–†–ö–ê –ü–û–ë–ï–î–ò–¢–ï–õ–Ø (–∫–Ω–æ–ø–∫–∞ "–ö–∞—Ä—Ç—ã")
   ‚îú‚îÄ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –≤—ã–±—Ä–∞–Ω –ª–∏ –ø–æ–±–µ–¥–∏—Ç–µ–ª—å
   ‚îú‚îÄ –°—Ä–∞–≤–Ω–∏—Ç—å —Å —Ä–µ–∞–ª—å–Ω—ã–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º
   ‚îú‚îÄ –ü–æ–∫–∞–∑–∞—Ç—å —Ç–æ—Å—Ç (–ø—Ä–∞–≤–∏–ª—å–Ω–æ/–æ—à–∏–±–∫–∞)
   ‚îî‚îÄ –î–æ–±–∞–≤–∏—Ç—å –æ—Å–Ω–æ–≤–Ω—É—é —Å—Ç–∞–≤–∫—É –≤ PayoutQueue

5. –û–ü–õ–ê–¢–ê –°–¢–ê–í–û–ö
   ‚îú‚îÄ –°–¥–µ–ª–∞—Ç—å –≤—Å–µ —Ñ–∏—à–∫–∏ –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–º–∏
   ‚îú‚îÄ –î–∏–ª–µ—Ä –∫–ª–∏–∫–∞–µ—Ç –Ω–∞ —Ñ–∏—à–∫—É ‚Üí PayoutScene
   ‚îú‚îÄ –û–ø–ª–∞—Ç–∞ ‚Üí –≤–æ–∑–≤—Ä–∞—Ç –Ω–∞ —ç–∫—Ä–∞–Ω —Å –∫–∞—Ä—Ç–∞–º–∏/—Ñ–∏—à–∫–∞–º–∏
   ‚îú‚îÄ PayoutQueue.mark_as_paid(bet_type)
   ‚îî‚îÄ –ü–æ–≤—Ç–æ—Ä—è—Ç—å –ø–æ–∫–∞ –µ—Å—Ç—å –Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ

6. –ó–ê–í–ï–†–®–ï–ù–ò–ï –†–ê–£–ù–î–ê
   ‚îú‚îÄ –î–∏–ª–µ—Ä –Ω–∞–∂–∏–º–∞–µ—Ç "–ö–∞—Ä—Ç—ã"
   ‚îú‚îÄ –ü—Ä–æ–≤–µ—Ä–∫–∞: –≤—Å–µ —Å—Ç–∞–≤–∫–∏ –æ–ø–ª–∞—á–µ–Ω—ã?
   ‚îú‚îÄ –ï—Å–ª–∏ –¥–∞ ‚Üí –Ω–æ–≤—ã–π —Ä–∞—É–Ω–¥
   ‚îî‚îÄ –ï—Å–ª–∏ –Ω–µ—Ç ‚Üí –û–®–ò–ë–ö–ê, –º–∏–Ω—É—Å –±–∞–ª–ª
```

---

## üìù –®–ê–ì 1: –î–û–ë–ê–í–ò–¢–¨ –£–ó–õ–´ –í –°–¶–ï–ù–£ Game.tscn

–û—Ç–∫—Ä—ã—Ç—å `scenes/Game.tscn` –≤ Godot Editor –∏ –¥–æ–±–∞–≤–∏—Ç—å:

### –§–∏—à–∫–∏ (TextureButton):

```
[node name="ChipPlayer" type="TextureButton" parent="."]
offset_left = 730.0
offset_top = 460.0
offset_right = 830.0
offset_bottom = 560.0
scale = Vector2(0.6, 0.6)
visible = false

[node name="ChipBanker" type="TextureButton" parent="."]
offset_left = 355.0
offset_top = 460.0
offset_right = 455.0
offset_bottom = 560.0
scale = Vector2(0.6, 0.6)
visible = false

[node name="ChipTie" type="TextureButton" parent="."]
offset_left = 538.0
offset_top = 460.0
offset_right = 638.0
offset_bottom = 560.0
scale = Vector2(0.6, 0.6)
visible = false

[node name="ChipPairPlayer" type="TextureButton" parent="."]
offset_left = 900.0
offset_top = 380.0
offset_right = 1000.0
offset_bottom = 480.0
scale = Vector2(0.4, 0.4)
visible = false

[node name="ChipPairBanker" type="TextureButton" parent="."]
offset_left = 190.0
offset_top = 380.0
offset_right = 290.0
offset_bottom = 480.0
scale = Vector2(0.4, 0.4)
visible = false
```

### Toggles –¥–ª—è –ø–∞—Ä (—É–∂–µ –µ—Å—Ç—å –¥–ª—è Player/Banker/Tie):

```
[node name="PayoutTogglePairPlayer" type="Button" parent="."]
offset_left = 1075.0
offset_top = 265.0
offset_right = 1180.0
offset_bottom = 296.0
text = "–ü–∞—Ä–∞ –ò–≥—Ä–æ–∫–∞"

[node name="PayoutTogglePairBanker" type="Button" parent="."]
offset_left = 1075.0
offset_top = 327.0
offset_right = 1190.0
offset_bottom = 358.0
text = "–ü–∞—Ä–∞ –ë–∞–Ω–∫–∏—Ä–∞"
```

---

## üìù –®–ê–ì 2: –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø –í GameController.gd

### 2.1. –û–±—ä—è–≤–∏—Ç—å –º–µ–Ω–µ–¥–∂–µ—Ä—ã (–≤ –Ω–∞—á–∞–ª–µ —Ñ–∞–π–ª–∞):

```gdscript
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# –ú–ï–ù–ï–î–ñ–ï–†–´
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

var chip_visual_manager: ChipVisualManager
var winner_selection_manager: WinnerSelectionManager
var payout_queue_manager: PayoutQueueManager
var pair_betting_manager: PairBettingManager
```

### 2.2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤ _ready():

```gdscript
func _ready():
	# ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ ...

	_setup_managers()
	_setup_payout_toggles()
	_setup_pair_toggles()
```

### 2.3. –ú–µ—Ç–æ–¥ _setup_managers():

```gdscript
func _setup_managers():
	"""–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤"""

	# ChipVisualManager
	chip_visual_manager = ChipVisualManager.new()
	var chip_player = get_node("ChipPlayer")
	var chip_banker = get_node("ChipBanker")
	var chip_tie = get_node("ChipTie")
	var chip_pair_player = get_node_or_null("ChipPairPlayer")
	var chip_pair_banker = get_node_or_null("ChipPairBanker")
	chip_visual_manager.setup(chip_player, chip_banker, chip_tie, chip_pair_player, chip_pair_banker)
	chip_visual_manager.chip_clicked.connect(_on_chip_clicked)

	# WinnerSelectionManager
	winner_selection_manager = WinnerSelectionManager.new()
	var player_marker = get_node("PlayerMarker")
	var banker_marker = get_node("BankerMarker")
	var tie_marker = get_node("TieMarker")
	winner_selection_manager.setup(player_marker, banker_marker, tie_marker)
	winner_selection_manager.winner_toggled.connect(_on_winner_toggled)

	# PayoutQueueManager
	payout_queue_manager = PayoutQueueManager.new()

	# PairBettingManager
	pair_betting_manager = PairBettingManager.new()
	pair_betting_manager.pair_detected.connect(_on_pair_detected)
	pair_betting_manager.pair_bet_placed.connect(_on_pair_bet_placed)

	print("‚úÖ –í—Å–µ –º–µ–Ω–µ–¥–∂–µ—Ä—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã")
```

### 2.4. –ú–µ—Ç–æ–¥ _setup_payout_toggles():

```gdscript
func _setup_payout_toggles():
	"""–ù–∞—Å—Ç—Ä–æ–π–∫–∞ toggles –¥–ª—è –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å—Ç–∞–≤–æ–∫"""

	var player_toggle = get_node_or_null("PayoutTogglePlayer")
	var banker_toggle = get_node_or_null("PayoutToggleBanker")
	var tie_toggle = get_node_or_null("PayoutToggleTie")

	if not player_toggle or not banker_toggle or not tie_toggle:
		push_warning("PayoutToggle –∫–Ω–æ–ø–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã!")
		return

	# –í–∫–ª—é—á–∞–µ–º toggle mode
	player_toggle.toggle_mode = true
	banker_toggle.toggle_mode = true
	tie_toggle.toggle_mode = true

	# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
	player_toggle.button_pressed = PayoutSettingsManager.player_payout_enabled
	banker_toggle.button_pressed = PayoutSettingsManager.banker_payout_enabled
	tie_toggle.button_pressed = PayoutSettingsManager.tie_payout_enabled

	# –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–∏—à–∫–∏ –µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ
	if player_toggle.button_pressed:
		chip_visual_manager.show_chip("Player")
	if banker_toggle.button_pressed:
		chip_visual_manager.show_chip("Banker")
	if tie_toggle.button_pressed:
		chip_visual_manager.show_chip("Tie")

	# –ü–æ–¥–∫–ª—é—á–∞–µ–º —Å–∏–≥–Ω–∞–ª—ã
	player_toggle.toggled.connect(_on_payout_toggle_player)
	banker_toggle.toggled.connect(_on_payout_toggle_banker)
	tie_toggle.toggled.connect(_on_payout_toggle_tie)

	print("‚úÖ Toggles –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å—Ç–∞–≤–æ–∫ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã")
```

### 2.5. –ú–µ—Ç–æ–¥ _setup_pair_toggles():

```gdscript
func _setup_pair_toggles():
	"""–ù–∞—Å—Ç—Ä–æ–π–∫–∞ toggles –¥–ª—è —Å—Ç–∞–≤–æ–∫ –Ω–∞ –ø–∞—Ä—ã"""

	var pair_player_toggle = get_node_or_null("PayoutTogglePairPlayer")
	var pair_banker_toggle = get_node_or_null("PayoutTogglePairBanker")

	if not pair_player_toggle or not pair_banker_toggle:
		print("‚ö†Ô∏è  Toggles –¥–ª—è –ø–∞—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)")
		return

	# –í–∫–ª—é—á–∞–µ–º toggle mode
	pair_player_toggle.toggle_mode = true
	pair_banker_toggle.toggle_mode = true

	# –ü–æ–¥–∫–ª—é—á–∞–µ–º —Å–∏–≥–Ω–∞–ª—ã
	pair_player_toggle.toggled.connect(_on_payout_toggle_pair_player)
	pair_banker_toggle.toggled.connect(_on_payout_toggle_pair_banker)

	print("‚úÖ Toggles –ø–∞—Ä –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã")
```

### 2.6. –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ toggles:

```gdscript
func _on_payout_toggle_player(enabled: bool):
	"""–ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Å—Ç–∞–≤–∫–∏ –Ω–∞ –∏–≥—Ä–æ–∫–∞"""
	PayoutSettingsManager.toggle_player(enabled)
	if enabled:
		chip_visual_manager.show_chip("Player")
	else:
		chip_visual_manager.hide_chip("Player")


func _on_payout_toggle_banker(enabled: bool):
	"""–ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Å—Ç–∞–≤–∫–∏ –Ω–∞ –±–∞–Ω–∫–∏—Ä–∞"""
	PayoutSettingsManager.toggle_banker(enabled)
	if enabled:
		chip_visual_manager.show_chip("Banker")
	else:
		chip_visual_manager.hide_chip("Banker")


func _on_payout_toggle_tie(enabled: bool):
	"""–ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Å—Ç–∞–≤–∫–∏ –Ω–∞ –Ω–∏—á—å—é"""
	PayoutSettingsManager.toggle_tie(enabled)
	if enabled:
		chip_visual_manager.show_chip("Tie")
	else:
		chip_visual_manager.hide_chip("Tie")


func _on_payout_toggle_pair_player(enabled: bool):
	"""–ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Å—Ç–∞–≤–∫–∏ –Ω–∞ –ø–∞—Ä—É –∏–≥—Ä–æ–∫–∞"""
	pair_betting_manager.toggle_pair_player_bet(enabled)
	if enabled:
		chip_visual_manager.show_chip("PairPlayer")
	else:
		chip_visual_manager.hide_chip("PairPlayer")


func _on_payout_toggle_pair_banker(enabled: bool):
	"""–ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Å—Ç–∞–≤–∫–∏ –Ω–∞ –ø–∞—Ä—É –±–∞–Ω–∫–∏—Ä–∞"""
	pair_betting_manager.toggle_pair_banker_bet(enabled)
	if enabled:
		chip_visual_manager.show_chip("PairBanker")
	else:
		chip_visual_manager.hide_chip("PairBanker")
```

---

## üìù –®–ê–ì 3: –ò–ó–ú–ï–ù–ò–¢–¨ –õ–û–ì–ò–ö–£ –†–ê–ó–î–ê–ß–ò –ö–ê–†–¢

–í –º–µ—Ç–æ–¥–µ —Ä–∞–∑–¥–∞—á–∏ –ø–µ—Ä–≤—ã—Ö 4 –∫–∞—Ä—Ç –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ø–∞—Ä:

```gdscript
func _after_first_four_cards_dealt():
	"""–ü–æ—Å–ª–µ —Ä–∞–∑–¥–∞—á–∏ –ø–µ—Ä–≤—ã—Ö 4 –∫–∞—Ä—Ç - –ø—Ä–æ–≤–µ—Ä—è–µ–º –ø–∞—Ä—ã"""

	# –ü–æ–ª—É—á–∞–µ–º –∫–∞—Ä—Ç—ã
	var player_card1 = player_cards[0]
	var player_card2 = player_cards[1]
	var banker_card1 = banker_cards[0]
	var banker_card2 = banker_cards[1]

	# –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–∞—Ä—ã
	var pair_results = pair_betting_manager.check_pairs(
		player_card1, player_card2, banker_card1, banker_card2
	)

	# –ï—Å–ª–∏ –µ—Å—Ç—å –ø–∞—Ä—ã - –¥–æ–±–∞–≤–ª—è–µ–º –≤ –æ—á–µ—Ä–µ–¥—å –≤—ã–ø–ª–∞—Ç
	for pair_type in pair_betting_manager.get_winning_pairs():
		var stake = 100.0  # –ò–ª–∏ –ø–æ–ª—É—á–∏—Ç—å –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫
		var payout = pair_betting_manager.calculate_pair_payout(stake, pair_type)
		payout_queue_manager.add_bet(pair_type, stake, payout, true)

	# –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ä–∞–∑–¥–∞—á—É —Ç—Ä–µ—Ç—å–∏—Ö –∫–∞—Ä—Ç...
```

---

## üìù –®–ê–ì 4: –ò–ó–ú–ï–ù–ò–¢–¨ –õ–û–ì–ò–ö–£ –ö–ù–û–ü–ö–ò "–ö–ê–†–¢–´"

–°—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞ –º–∞—Ä–∫–µ—Ä–æ–≤ —É–¥–∞–ª–µ–Ω–∞. –¢–µ–ø–µ—Ä—å:

```gdscript
func _on_cards_button_pressed():
	"""–ù–∞–∂–∞—Ç–∏–µ –Ω–∞ –∫–Ω–æ–ø–∫—É –ö–∞—Ä—Ç—ã - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è"""

	# –ü—Ä–æ–≤–µ—Ä–∫–∞ 1: –ï—Å–ª–∏ —Ä–∞—É–Ω–¥ –Ω–µ –∑–∞–≤–µ—Ä—à–µ–Ω - –Ω–∞—á–∏–Ω–∞–µ–º —Ä–∞–∑–¥–∞—á—É
	if game_state == GameState.WAITING_FOR_CARDS:
		_start_dealing()
		return

	# –ü—Ä–æ–≤–µ—Ä–∫–∞ 2: –ï—Å–ª–∏ –µ—Å—Ç—å –Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ —Å—Ç–∞–≤–∫–∏ - –û–®–ò–ë–ö–ê
	if payout_queue_manager.has_unpaid_winning_bets():
		_handle_error("–°–Ω–∞—á–∞–ª–∞ –æ–ø–ª–∞—Ç–∏—Ç–µ –≤—Å–µ —Å—Ç–∞–≤–∫–∏!")
		return

	# –ü—Ä–æ–≤–µ—Ä–∫–∞ 3: –ï—Å–ª–∏ —Ä–∞—É–Ω–¥ –∑–∞–≤–µ—Ä—à–µ–Ω –∏ –≤—Å–µ –æ–ø–ª–∞—á–µ–Ω–æ - –Ω–æ–≤—ã–π —Ä–∞—É–Ω–¥
	if game_state == GameState.ROUND_FINISHED:
		_start_new_round()
		return

	# –ü—Ä–æ–≤–µ—Ä–∫–∞ 4: –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—ã–±–æ—Ä –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
	if game_state == GameState.WAITING_FOR_WINNER_SELECTION:
		_validate_winner_selection()
```

```gdscript
func _validate_winner_selection():
	"""–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—ã–±–æ—Ä –ø–æ–±–µ–¥–∏—Ç–µ–ª—è"""

	# –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤—ã–±—Ä–∞–Ω –ª–∏ –ø–æ–±–µ–¥–∏—Ç–µ–ª—å
	if not winner_selection_manager.is_winner_selected():
		show_toast("‚ùå –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è!", 2.0)
		return

	var selected_winner = winner_selection_manager.get_selected_winner()
	var actual_winner = _calculate_actual_winner()

	# –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å
	if selected_winner == actual_winner:
		# –ü–†–ê–í–ò–õ–¨–ù–û
		show_toast("‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ! –í—ã–∏–≥—Ä–∞–ª %s" % actual_winner, 3.0)
		GameStateManager.increment_correct()

		# –î–æ–±–∞–≤–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω—É—é —Å—Ç–∞–≤–∫—É –≤ –æ—á–µ—Ä–µ–¥—å
		_add_main_bet_to_queue(actual_winner)

		# –î–µ–ª–∞–µ–º —Ñ–∏—à–∫–∏ –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–º–∏ –¥–ª—è –æ–ø–ª–∞—Ç—ã
		chip_visual_manager.make_all_chips_clickable(true)

		# –ú–µ–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
		game_state = GameState.WAITING_FOR_PAYOUT

	else:
		# –û–®–ò–ë–ö–ê
		show_toast("‚ùå –û—à–∏–±–∫–∞! –í—ã–∏–≥—Ä–∞–ª %s, –∞ –Ω–µ %s" % [actual_winner, selected_winner], 3.0)
		GameStateManager.increment_errors()
		_start_new_round()
```

---

## üìù –®–ê–ì 5: –†–ï–ê–õ–ò–ó–û–í–ê–¢–¨ –ö–õ–ò–ö –ù–ê –§–ò–®–ö–£

```gdscript
func _on_chip_clicked(bet_type: String):
	"""–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞ –Ω–∞ —Ñ–∏—à–∫—É - –ø–µ—Ä–µ—Ö–æ–¥ –≤ PayoutScene"""

	# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —ç—Ç–æ –≤—ã–∏–≥—Ä–∞–≤—à–∞—è –∏ –Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω–∞—è —Å—Ç–∞–≤–∫–∞
	var bet = payout_queue_manager.get_bet_by_type(bet_type)
	if not bet:
		show_toast("‚ùå –ù–µ—Ç —Å—Ç–∞–≤–∫–∏ %s" % bet_type, 2.0)
		return

	if not bet.won:
		show_toast("‚ùå –≠—Ç–∞ —Å—Ç–∞–≤–∫–∞ –Ω–µ –≤—ã–∏–≥—Ä–∞–ª–∞" % bet_type, 2.0)
		return

	if bet.is_paid:
		show_toast("‚úÖ –≠—Ç–∞ —Å—Ç–∞–≤–∫–∞ —É–∂–µ –æ–ø–ª–∞—á–µ–Ω–∞", 2.0)
		return

	# –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
	_save_game_state_for_return()

	# –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ PayoutScene
	_open_payout_scene(bet_type, bet.stake, bet.payout)
```

```gdscript
func _open_payout_scene(bet_type: String, stake: float, expected_payout: float):
	"""–û—Ç–∫—Ä—ã—Ç—å —Å—Ü–µ–Ω—É –≤—ã–ø–ª–∞—Ç—ã"""

	# –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç
	PayoutContextManager.set_context({
		"bet_type": bet_type,
		"stake": stake,
		"expected_payout": expected_payout,
		"return_to_game": true
	})

	# –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ PayoutScene
	get_tree().change_scene_to_file("res://scenes/PayoutScene.tscn")
```

---

## üìù –®–ê–ì 6: –í–û–ó–í–†–ê–¢ –ò–ó PayoutScene

–í PayoutScene –ø–æ—Å–ª–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –æ–ø–ª–∞—Ç—ã:

```gdscript
func _on_payout_validated_correctly():
	"""–ü–æ—Å–ª–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –æ–ø–ª–∞—Ç—ã"""

	var context = PayoutContextManager.get_context()

	if context.return_to_game:
		# –û—Ç–º–µ—á–∞–µ–º —Å—Ç–∞–≤–∫—É –∫–∞–∫ –æ–ø–ª–∞—á–µ–Ω–Ω—É—é
		EventBus.payout_completed.emit(context.bet_type)

		# –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –≤ Game
		get_tree().change_scene_to_file("res://scenes/Game.tscn")
```

–í GameController.gd –ø–æ–¥–∫–ª—é—á–∞–µ–º —Å–∏–≥–Ω–∞–ª:

```gdscript
func _ready():
	# ...
	EventBus.payout_completed.connect(_on_payout_completed)


func _on_payout_completed(bet_type: String):
	"""–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ–ø–ª–∞—Ç—ã"""

	# –û—Ç–º–µ—á–∞–µ–º –∫–∞–∫ –æ–ø–ª–∞—á–µ–Ω–Ω—É—é
	payout_queue_manager.mark_as_paid(bet_type)

	# –°–∫—Ä—ã–≤–∞–µ–º —Ñ–∏—à–∫—É
	chip_visual_manager.hide_chip(bet_type)

	# –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤—Å–µ –ª–∏ –æ–ø–ª–∞—á–µ–Ω–æ
	if payout_queue_manager.is_all_paid():
		show_toast("‚úÖ –í—Å–µ —Å—Ç–∞–≤–∫–∏ –æ–ø–ª–∞—á–µ–Ω—ã! –ù–∞–∂–º–∏—Ç–µ –ö–∞—Ä—Ç—ã", 3.0)
		game_state = GameState.ROUND_FINISHED
```

---

## üìù –®–ê–ì 7: –ù–û–í–´–ô –†–ê–£–ù–î

```gdscript
func _start_new_round():
	"""–ù–∞—á–∞—Ç—å –Ω–æ–≤—ã–π —Ä–∞—É–Ω–¥"""

	# –û—á–∏—â–∞–µ–º –º–µ–Ω–µ–¥–∂–µ—Ä—ã
	payout_queue_manager.clear()
	pair_betting_manager.reset_round()
	winner_selection_manager.reset()
	chip_visual_manager.hide_all_chips()

	# –†–∞–Ω–¥–æ–º–∏–∑–∏—Ä—É–µ–º —Å—Ç–∞–≤–∫–∏ –Ω–∞ –ø–∞—Ä—ã (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
	# pair_betting_manager.randomize_pair_bets()

	# –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–∏—à–∫–∏ —Å–æ–≥–ª–∞—Å–Ω–æ toggles
	_refresh_chips_visibility()

	# –°–±—Ä–æ—Å –∫–∞—Ä—Ç –∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è
	# ...

	game_state = GameState.WAITING_FOR_CARDS
```

---

## ‚úÖ –ò–¢–û–ì–û

### –°–æ–∑–¥–∞–Ω–æ:
- ‚úÖ ChipVisualManager.gd
- ‚úÖ WinnerSelectionManager.gd
- ‚úÖ PayoutQueueManager.gd
- ‚úÖ PairBettingManager.gd

### –ù—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ GameController.gd:
1. –û–±—ä—è–≤–ª–µ–Ω–∏–µ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
2. _setup_managers()
3. _setup_payout_toggles()
4. _setup_pair_toggles()
5. –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ toggles
6. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä –ø–æ—Å–ª–µ –ø–µ—Ä–≤—ã—Ö 4 –∫–∞—Ä—Ç
7. –ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ –∫–Ω–æ–ø–∫–∏ "–ö–∞—Ä—Ç—ã"
8. _on_chip_clicked()
9. _on_payout_completed()
10. –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π _start_new_round()

### –ù—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ Game.tscn:
1. 5 —É–∑–ª–æ–≤ TextureButton –¥–ª—è —Ñ–∏—à–µ–∫
2. 2 —É–∑–ª–∞ Button –¥–ª—è toggles –ø–∞—Ä

### –ù—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å:
- PayoutContextManager (singleton –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –º–µ–∂–¥—É —Å—Ü–µ–Ω–∞–º–∏)

---

## üîÑ –ü–û–°–õ–ï–î–û–í–ê–¢–ï–õ–¨–ù–û–°–¢–¨ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø

1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∏–≥—Ä—É
2. –í–∫–ª—é—á–∏—Ç—å toggles (Player, Banker, Tie) - —Ñ–∏—à–∫–∏ –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è
3. –ù–∞–∂–∞—Ç—å "–ö–∞—Ä—Ç—ã" - –Ω–∞—á–Ω–µ—Ç—Å—è —Ä–∞–∑–¥–∞—á–∞
4. –ü–æ—Å–ª–µ —Ä–∞–∑–¥–∞—á–∏ - –∫–ª–∏–∫–Ω—É—Ç—å –Ω–∞ –º–∞—Ä–∫–µ—Ä –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
5. –ù–∞–∂–∞—Ç—å "–ö–∞—Ä—Ç—ã" - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏
6. –ö–ª–∏–∫–Ω—É—Ç—å –Ω–∞ —Ñ–∏—à–∫—É - –ø–µ—Ä–µ—Ö–æ–¥ –≤ PayoutScene
7. –û–ø–ª–∞—Ç–∏—Ç—å - –≤–æ–∑–≤—Ä–∞—Ç –≤ –∏–≥—Ä—É, —Ñ–∏—à–∫–∞ –∏—Å—á–µ–∑–ª–∞
8. –ï—Å–ª–∏ –µ—Å—Ç—å –µ—â–µ —Å—Ç–∞–≤–∫–∏ - –ø–æ–≤—Ç–æ—Ä–∏—Ç—å 6-7
9. –ù–∞–∂–∞—Ç—å "–ö–∞—Ä—Ç—ã" - –Ω–æ–≤—ã–π —Ä–∞—É–Ω–¥

---

## üéì –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

1. –°–æ–∑–¥–∞—Ç—å PayoutContextManager.gd (singleton)
2. –î–æ–±–∞–≤–∏—Ç—å –∫–æ–¥ –≤ GameController.gd —Å–æ–≥–ª–∞—Å–Ω–æ –ø–ª–∞–Ω—É
3. –î–æ–±–∞–≤–∏—Ç—å —É–∑–ª—ã –≤ Game.tscn
4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
5. –û—Ç–ª–∞–¥–∏—Ç—å
6. –î–æ–±–∞–≤–∏—Ç—å —Ä–∞–Ω–¥–æ–º–∏–∑–∞—Ü–∏—é —Å—Ç–∞–≤–æ–∫ –Ω–∞ –ø–∞—Ä—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
